<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chiáº¿c KhÄƒn Nhiá»‡m MÃ u â€“ Giáº£i Cá»©u TrÃ¡i Äáº¥t Xanh ğŸŒ</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
  body {
    margin: 0;
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(135deg, #A8E6CF, #DCEDC1);
    overflow-x: hidden;
  }

  /* Start Screen */
  #start-screen, #result-screen {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    height: 100vh;
  }

  h1 {
    font-size: 2em;
    color: #2b593f;
    margin-bottom: 10px;
  }

  p.story {
    font-size: 1.1em;
    color: #444;
    max-width: 600px;
    margin-bottom: 20px;
  }

  button {
    padding: 10px 20px;
    border: none;
    border-radius: 10px;
    background-color: #FFAAA5;
    color: white;
    font-size: 1em;
    cursor: pointer;
    transition: 0.3s;
  }

  button:hover {
    background-color: #FF8C7A;
    transform: scale(1.05);
  }

  /* Game Layout */
  #game-container {
    display: none;
    height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  #instruction {
    background: rgba(255,255,255,0.8);
    padding: 10px 20px;
    border-radius: 10px;
    color: #2b593f;
    margin-bottom: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }

  #tablecloth {
    display: grid;
    grid-template-areas:
      "air . water"
      ". center ."
      "soil . noise";
    gap: 20px;
    align-items: center;
    justify-items: center;
  }

  .zone {
    width: 200px;
    height: 180px;
    background: white;
    border-radius: 15px;
    box-shadow: 0 3px 8px rgba(0,0,0,0.2);
    padding: 10px;
    text-align: center;
    transition: 0.3s;
  }

  .zone.completed {
    background: #A8E6CF;
    box-shadow: 0 0 20px #7ae7a1;
  }

  .zone textarea {
    width: 90%;
    height: 80px;
    border-radius: 8px;
    border: 1px solid #ccc;
    resize: none;
    padding: 5px;
  }

  #center-zone {
    grid-area: center;
    background: #E0F7FA;
    text-align: center;
  }

  #combine-btn {
    display: none;
    margin-top: 10px;
    padding: 10px 20px;
    background: #77dd77;
  }

  /* CHá»ˆ Sá»¬A á» ÄÃ‚Y: KhÃ´ng áº©n nÃºt ná»™p bÃ i trong giai Ä‘oáº¡n 2 */
  #submit-solution-btn {
    margin-top: 10px;
    padding: 10px 20px;
    background: #4CAF50;
    color: white;
    border-radius: 10px;
  }

  #earth-img {
    width: 120px;
    margin-bottom: 10px;
    transition: filter 2s, transform 2s;
    filter: grayscale(80%);
  }

  .clean-earth {
    filter: grayscale(0%);
    transform: rotate(360deg) scale(1.1);
  }

  /* Confetti leaves */
  .leaf {
    position: fixed;
    width: 30px;
    height: 30px;
    background-size: cover;
    animation: fall linear forwards;
  }

  @keyframes fall {
    from { top: -50px; transform: rotate(0deg); }
    to { top: 100vh; transform: rotate(360deg); }
  }

  /* Result Screen */
  #result-screen {
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: rgba(255,255,255,0.95);
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
  }

  .definition-box {
    background: #E8F5E9;
    border-radius: 10px;
    padding: 15px 25px;
    margin-top: 15px;
    max-width: 700px;
  }
</style>
</head>
<body>

<!-- ğŸ”¹ Start Screen -->
<div id="start-screen">
  <h1>Chiáº¿c KhÄƒn Nhiá»‡m MÃ u â€“ Giáº£i Cá»©u TrÃ¡i Äáº¥t Xanh ğŸŒ</h1>
  <p class="story">TrÃ¡i Äáº¥t Ä‘ang bá»‹ Ã´ nhiá»…m! CÃ¡c NhÃ  Äiá»u Tra MÃ´i TrÆ°á»ng hÃ£y há»£p sá»©c cá»©u láº¥y hÃ nh tinh xanh!</p>
  <button onclick="startGame()">Báº¯t Ä‘áº§u nhiá»‡m vá»¥</button>
  <div id="earth-ticker" style="margin-top:30px;">
    <img src="https://cdn-icons-png.flaticon.com/512/427/427735.png" width="80">
  </div>
</div>

<!-- ğŸ”¹ Main Game -->
<div id="game-container">
  <div id="instruction">
    <b>HÆ°á»›ng dáº«n:</b> HÃ£y cÃ¹ng Ä‘á»™i cá»§a báº¡n viáº¿t Ã½ kiáº¿n vá» cÃ¡c dáº¡ng Ã´ nhiá»…m (KhÃ´ng khÃ­, NÆ°á»›c, Äáº¥t, Ã‚m thanh) á»Ÿ bá»‘n gÃ³c.
    Sau Ä‘Ã³, káº¿t há»£p nÄƒng lÆ°á»£ng xanh vÃ  nÃªu biá»‡n phÃ¡p báº£o vá»‡ mÃ´i trÆ°á»ng nhÃ©!
  </div>

  <div id="tablecloth">
    <div class="zone" id="air-zone" style="grid-area: air;">
      ğŸ’¨ <b>KhÃ´ng khÃ­</b><br>
      <textarea placeholder="Viáº¿t Ã½ kiáº¿n cá»§a báº¡nâ€¦"></textarea><br>
      <button onclick="completeZone('air')">HoÃ n thÃ nh</button>
    </div>

    <div class="zone" id="water-zone" style="grid-area: water;">
      ğŸ’§ <b>NÆ°á»›c</b><br>
      <textarea placeholder="Viáº¿t Ã½ kiáº¿n cá»§a báº¡nâ€¦"></textarea><br>
      <button onclick="completeZone('water')">HoÃ n thÃ nh</button>
    </div>

    <div class="zone" id="soil-zone" style="grid-area: soil;">
      ğŸŒ <b>Äáº¥t</b><br>
      <textarea placeholder="Viáº¿t Ã½ kiáº¿n cá»§a báº¡nâ€¦"></textarea><br>
      <button onclick="completeZone('soil')">HoÃ n thÃ nh</button>
    </div>

    <div class="zone" id="noise-zone" style="grid-area: noise;">
      ğŸ”Š <b>Ã‚m thanh</b><br>
      <textarea placeholder="Viáº¿t Ã½ kiáº¿n cá»§a báº¡nâ€¦"></textarea><br>
      <button onclick="completeZone('noise')">HoÃ n thÃ nh</button>
    </div>

    <div class="zone" id="center-zone">
      <img id="earth-img" src="https://cdn-icons-png.flaticon.com/512/427/427735.png" alt="Earth">
      <div id="combined-ideas"></div>
      <button id="combine-btn" onclick="combineIdeas()">Káº¿t há»£p nÄƒng lÆ°á»£ng xanh ğŸŒ¿</button>
      <div id="solution-phase" style="display:none;">
        <p><b>Giai Ä‘oáº¡n 2:</b> HÃ£y Ä‘á» xuáº¥t biá»‡n phÃ¡p báº£o vá»‡ mÃ´i trÆ°á»ng ğŸŒ±</p>
        <textarea id="solution-text" placeholder="Viáº¿t biá»‡n phÃ¡p cá»§a nhÃ³m..."></textarea><br>
        <button id="submit-solution-btn" onclick="submitFinal()">Ná»™p bÃ i</button>
      </div>
    </div>
  </div>
</div>

<!-- ğŸ”¹ Result Screen -->
<div id="result-screen">
  <h2>Káº¿t quáº£ nhiá»‡m vá»¥</h2>
  <p id="result-message"></p>
  <div class="definition-box">
    <b>KhÃ¡i niá»‡m:</b> Ã” nhiá»…m mÃ´i trÆ°á»ng lÃ  sá»± biáº¿n Ä‘á»•i tÃ­nh cháº¥t váº­t lÃ­, hÃ³a há»c, sinh há»c cá»§a thÃ nh pháº§n mÃ´i trÆ°á»ng khÃ´ng phÃ¹ há»£p vá»›i quy chuáº©n kÄ© thuáº­t mÃ´i trÆ°á»ng, tiÃªu chuáº©n mÃ´i trÆ°á»ng gÃ¢y áº£nh hÆ°á»Ÿng xáº¥u Ä‘áº¿n sá»©c khoáº» con ngÆ°á»i, sinh váº­t vÃ  tá»± nhiÃªn.
  </div>
  <button onclick="location.reload()">ChÆ¡i láº¡i ğŸ”</button>
</div>

<!-- ğŸ”Š Sounds -->
<audio id="click-sound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_7c89d43a1d.mp3?filename=click-124467.mp3"></audio>
<audio id="cheer-sound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_730c6b82e0.mp3?filename=success-1-6297.mp3"></audio>

<script>
let completed = {air:false, water:false, soil:false, noise:false};

function startGame(){
  document.getElementById("start-screen").style.display = "none";
  document.getElementById("game-container").style.display = "flex";
}

function completeZone(zone){
  document.getElementById("click-sound").play();
  const z = document.getElementById(zone+"-zone");
  z.classList.add("completed");
  z.querySelector("button").disabled = true;
  completed[zone] = true;
  if(Object.values(completed).every(v => v)) {
    document.getElementById("combine-btn").style.display = "inline-block";
  }
}

// Khi káº¿t há»£p nÄƒng lÆ°á»£ng xanh
function combineIdeas(){
  document.getElementById("click-sound").play();
  const ideas = [];
  for(let z in completed){
    const text = document.getElementById(z+"-zone").querySelector("textarea").value.trim();
    ideas.push(text);
  }
  const combinedDiv = document.getElementById("combined-ideas");
  combinedDiv.innerHTML = "<b>Ã kiáº¿n nhÃ³m:</b><br>" + ideas.join("<br>â¡ï¸ ");
  document.getElementById("earth-img").classList.add("clean-earth");

  // Hiá»‡n giai Ä‘oáº¡n 2
  document.getElementById("combine-btn").style.display = "none";
  setTimeout(()=>{ 
    document.getElementById("solution-phase").style.display = "block"; 
  }, 2000);
}

// Ná»™p bÃ i - cháº¥m Ä‘iá»ƒm
function submitFinal(){
  const solution = document.getElementById("solution-text").value.trim();
  const allIdeas = [...document.querySelectorAll("textarea")].map(t=>t.value).join(" ").toLowerCase();

  const fullText = (allIdeas + " " + solution).toLowerCase();

  const keywords = [
    "rÃ¡c", "rÃ¡c tháº£i", "khÃ³i", "bá»¥i", "bá»¥i báº©n",
    "nÆ°á»›c báº©n", "nÆ°á»›c tháº£i", "Ã´ nhiá»…m", "áº£nh hÆ°á»Ÿng",
    "con ngÆ°á»i", "thiÃªn nhiÃªn", "mÃ´i trÆ°á»ng"
  ];

  let score = 0;
  keywords.forEach(k => { if(fullText.includes(k)) score += 10; });
  if(score > 100) score = 100;

  showResult(score);
}

// Hiá»ƒn thá»‹ káº¿t quáº£
function showResult(score){
  document.getElementById("result-screen").style.display = "flex";
  let msg = "";
  if(score >= 80){
    msg = "ğŸŸ¢ Tuyá»‡t vá»i! TrÃ¡i Äáº¥t há»“i sinh rá»±c rá»¡!";
    document.getElementById("cheer-sound").play();
    launchConfetti();
  } else if(score >= 50){
    msg = "ğŸŸ¡ TrÃ¡i Äáº¥t Ä‘ang Ä‘Æ°á»£c cá»©u, cá»‘ gáº¯ng thÃªm nhÃ©!";
  } else {
    msg = "ğŸ”´ TrÃ¡i Äáº¥t váº«n Ä‘ang nguy cáº¥p, hÃ£y Ä‘iá»u tra láº¡i!";
  }
  document.getElementById("result-message").innerText = msg;
}

// Confetti xanh lÃ¡ cÃ¢y
function launchConfetti(){
  for(let i=0;i<40;i++){
    const leaf = document.createElement('div');
    leaf.classList.add('leaf');
    leaf.style.backgroundImage = "url('https://cdn-icons-png.flaticon.com/512/2909/2909765.png')";
    leaf.style.left = Math.random()*window.innerWidth + 'px';
    leaf.style.animationDuration = (4 + Math.random()*3) + 's';
    document.body.appendChild(leaf);
    setTimeout(()=>leaf.remove(),8000);
  }
}
</script>
</body>
</html>
